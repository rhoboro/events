# ゲームボーイ開発のすすめ

2022年の前半は週末プログラミングでゲームボーイエミュレータを作っていた。
コードは https://github.com/rhoboro/rustboy にある。

## 概要

- 期間
    - 2021年末 - 2022年4月末の週末、祝日
- 内容
    - 他人のコードを見ず、仕様を頼りにゲームボーイエミュレータを実装する。
    - 練習も兼ねて Rust x 標準ライブラリのみで実装
    - テトリスがそれなりに動いたので満足して終了
        - カートリッジの規格が何種類もあり、テトリスは1番シンプルなもの

## モチベーション

### 写経に飽きていた

- 印象に残っている面白かった書籍のはこのあたり。
    - [30日でできる! OS自作入門](https://book.mynavi.jp/ec/products/detail/id=22078)
    - [Go言語で作るインタプリタ](https://www.oreilly.co.jp/books/9784873118222/)
    -  [Rustで始めるTCP自作入門](https://techbookfest.org/product/6562563816947712?productVariantID=5842153718677504)

### 力試し

- 仕様だけを頼りに実装する
    - 他人のコードは極力見ないで実装
    - 一部の命令は実際に動いている PyBoy を参考にした
        - 有志による仕様書は正しいとは限らない
- Rust の練習を兼ねて一定サイズのコードを書いてみたかった
    - Rust を知りたいので標準ライブラリ縛り
- CS や低レイヤの基礎を体感する
    - CPUとは？メモリとは？プログラムとデータの違いとは？
    - ビット演算
    - スタックの使い方や関数コール
    - なるべく愚直に実装

## 感想

- 誰でもどんな言語でもできるのでみんなやってみよう
- すごく単純な命令だけで動いていることを体感できた
    - 当然知っているし、理解もしていたつもりだった
    - 「知っている」だけとはまた違う感覚
- いろんな発見があり、とても面白かった
    - わからなくても忠実に実装していると、あとで「このためのものだったのか」となる
    - 「同じように見えて微妙に違う」がよくある。見落とすとハマる。
        - あるCPU命令だけは見るべきビット位置が違うとか
- 80% 以上の時間をバグ解消に費やした気がする
    - 信じられる仕様書がない。動いているコードを参考にせざるを得ないときも。
    - 秒で数万行のログが秒で吐かれる。ほとんど同じログの繰り返しの中、微妙な差異で変わる挙動。
    - 途中でデバッガーも実装しておいてよかった。
    - Rust ゆえのちゃぶ台返しも何度か食らった気がする
- ハッカー文化はやっぱり面白い
    - ゲームボーイはどんな言語でも実装事例がありそう
    - 先人がまとめてくれた資料は神
    - Test Rom の存在もとても大きかった
        - CPU 命令が正しいかチェックして結果を背景として表示してくれるものなど
        - これを動かすための実装はがんばるしかない

